#ifndef _ASM_H_
#define _ASM_H_

#include "util.h"

const char int3[] = {0x33};

#ifdef ENVIRONMENT64
// 64-bit version
const char clear[] = {
    // Clear all registers
    0x48, 0x31, 0xC0, // xor    rax,rax
    0x48, 0x31, 0xDB, // xor    rbx,rbx
    0x48, 0x31, 0xC9, // xor    rcx,rcx
    0x48, 0x31, 0xD2, // xor    rdx,rdx
    0x48, 0x31, 0xF6, // xor    rsi,rsi
    0x48, 0x31, 0xFF, // xor    rdi,rdi
    0x4D, 0x31, 0xC0, // xor    r8,r8
    0x4D, 0x31, 0xC9, // xor    r9,r9
    0x4D, 0x31, 0xD2, // xor    r10,r10
    0x4D, 0x31, 0xDB, // xor    r11,r11
    0x4D, 0x31, 0xE4, // xor    r12,r12
    0x4D, 0x31, 0xED, // xor    r13,r13
    0x4D, 0x31, 0xF6, // xor    r14,r14
    0x4D, 0x31, 0xFF, // xor    r15,r15
    // Reset stack
    0x48, 0x89, 0xEC // mov    rsp,rbp
};
#else
// 32-bit version
const char clear[] = {
    // Clear all registers
    0x31, 0xC0, // xor    eax,eax
    0x31, 0xDB, // xor    ebx,ebx
    0x31, 0xC9, // xor    ecx,ecx
    0x31, 0xD2, // xor    edx,edx
    0x31, 0xF6, // xor    esi,esi
    0x31, 0xFF, // xor    edi,edi
    // Reset stack
    0x89, 0xEC // mov    esp,ebp
};
#endif

#endif